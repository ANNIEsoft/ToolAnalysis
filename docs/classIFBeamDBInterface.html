<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ToolDAQFramework: IFBeamDBInterface Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>IFBeamDBInterface Class Reference</h1><!-- doxytag: class="IFBeamDBInterface" -->
<p>Singleton used to interact with the Intensity Frontier beam database at Fermilab.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="IFBeamDBInterface_8h_source.html">IFBeamDBInterface.h</a>&gt;</code></p>

<p><a href="classIFBeamDBInterface-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac6e95cfed4db9c455289234f26a2f1c1"></a><!-- doxytag: member="IFBeamDBInterface::~IFBeamDBInterface" ref="ac6e95cfed4db9c455289234f26a2f1c1" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIFBeamDBInterface.html#ac6e95cfed4db9c455289234f26a2f1c1">~IFBeamDBInterface</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clean up libcurl stuff as the <a class="el" href="classIFBeamDBInterface.html" title="Singleton used to interact with the Intensity Frontier beam database at Fermilab...">IFBeamDBInterface</a> object is destroyed. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5a3bc058c6b8ca2e3d13b85ca1f42e2d"></a><!-- doxytag: member="IFBeamDBInterface::IFBeamDBInterface" ref="a5a3bc058c6b8ca2e3d13b85ca1f42e2d" args="(const IFBeamDBInterface &amp;)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIFBeamDBInterface.html#a5a3bc058c6b8ca2e3d13b85ca1f42e2d">IFBeamDBInterface</a> (const <a class="el" href="classIFBeamDBInterface.html">IFBeamDBInterface</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deleted copy constructor. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a25624ce40601f7ee32b039c34466d5cc"></a><!-- doxytag: member="IFBeamDBInterface::IFBeamDBInterface" ref="a25624ce40601f7ee32b039c34466d5cc" args="(IFBeamDBInterface &amp;&amp;)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIFBeamDBInterface.html#a25624ce40601f7ee32b039c34466d5cc">IFBeamDBInterface</a> (<a class="el" href="classIFBeamDBInterface.html">IFBeamDBInterface</a> &amp;&amp;)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deleted move constructor. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9550adf51f7c043e9ba628e920202ec2"></a><!-- doxytag: member="IFBeamDBInterface::operator=" ref="a9550adf51f7c043e9ba628e920202ec2" args="(const IFBeamDBInterface &amp;)" -->
<a class="el" href="classIFBeamDBInterface.html">IFBeamDBInterface</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIFBeamDBInterface.html#a9550adf51f7c043e9ba628e920202ec2">operator=</a> (const <a class="el" href="classIFBeamDBInterface.html">IFBeamDBInterface</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deleted copy assignment operator. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a66a70c1666620601852ceec5038c3c62"></a><!-- doxytag: member="IFBeamDBInterface::operator=" ref="a66a70c1666620601852ceec5038c3c62" args="(IFBeamDBInterface &amp;&amp;)" -->
<a class="el" href="classIFBeamDBInterface.html">IFBeamDBInterface</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIFBeamDBInterface.html#a66a70c1666620601852ceec5038c3c62">operator=</a> (<a class="el" href="classIFBeamDBInterface.html">IFBeamDBInterface</a> &amp;&amp;)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deleted move assignment operator. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; std::string, <br class="typebreak"/>
std::map&lt; uint64_t, <br class="typebreak"/>
<a class="el" href="structBeamDataPoint.html">BeamDataPoint</a> &gt; &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIFBeamDBInterface.html#a7b0e4c42767791f1904540b63772a74d">QueryBeamDB</a> (uint64_t t0, uint64_t t1) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get information about the Booster Neutrino Beam (BNB) state from the database for the time interval [t0, t1].  <a href="#a7b0e4c42767791f1904540b63772a74d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIFBeamDBInterface.html#a034ef023cb78989270a4ec2d54a5aa4f">QueryBeamDB</a> (uint64_t t0, uint64_t t1, std::string &amp;response_string) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get information about the BNB state from the database for the time interval [t0, t1].  <a href="#a034ef023cb78989270a4ec2d54a5aa4f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classBeamStatus.html">BeamStatus</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIFBeamDBInterface.html#add525c53cbf0b85c3cd0d39a5b9b0fdd">GetBeamStatus</a> (uint64_t time) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get information about the BNB state from the database as close as possible to a given time.  <a href="#add525c53cbf0b85c3cd0d39a5b9b0fdd"></a><br/></td></tr>
<tr><td colspan="2"><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a677ed1a3b7dbfc70ffb0688078ae5fb0"></a><!-- doxytag: member="IFBeamDBInterface::Instance" ref="a677ed1a3b7dbfc70ffb0688078ae5fb0" args="()" -->
static const <a class="el" href="classIFBeamDBInterface.html">IFBeamDBInterface</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIFBeamDBInterface.html#a677ed1a3b7dbfc70ffb0688078ae5fb0">Instance</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a const reference to the singleton instance of the <a class="el" href="classIFBeamDBInterface.html" title="Singleton used to interact with the Intensity Frontier beam database at Fermilab...">IFBeamDBInterface</a>. <br/></td></tr>
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af5275e528b9b43d4c5dacd0a8a3ca62b"></a><!-- doxytag: member="IFBeamDBInterface::IFBeamDBInterface" ref="af5275e528b9b43d4c5dacd0a8a3ca62b" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIFBeamDBInterface.html#af5275e528b9b43d4c5dacd0a8a3ca62b">IFBeamDBInterface</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create the singleton <a class="el" href="classIFBeamDBInterface.html" title="Singleton used to interact with the Intensity Frontier beam database at Fermilab...">IFBeamDBInterface</a> object. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a950bec54fb41eaf48471a8a1eab8ab71"></a><!-- doxytag: member="IFBeamDBInterface::ParseDBResponse" ref="a950bec54fb41eaf48471a8a1eab8ab71" args="(const std::string &amp;response) const " -->
std::map&lt; std::string, <br class="typebreak"/>
std::map&lt; uint64_t, <br class="typebreak"/>
<a class="el" href="structBeamDataPoint.html">BeamDataPoint</a> &gt; &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>ParseDBResponse</b> (const std::string &amp;response) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2d7b151e8b21fe5f7d255d442d37e321"></a><!-- doxytag: member="IFBeamDBInterface::PostprocessParsedResponse" ref="a2d7b151e8b21fe5f7d255d442d37e321" args="(std::map&lt; std::string, std::map&lt; uint64_t, BeamDataPoint &gt; &gt; &amp;parsed_response) const " -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>PostprocessParsedResponse</b> (std::map&lt; std::string, std::map&lt; uint64_t, <a class="el" href="structBeamDataPoint.html">BeamDataPoint</a> &gt; &gt; &amp;parsed_response) const </td></tr>
<tr><td colspan="2"><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7dea07c539e0f0ca765f02d198345d2d"></a><!-- doxytag: member="IFBeamDBInterface::fCurl" ref="a7dea07c539e0f0ca765f02d198345d2d" args="" -->
CURL *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIFBeamDBInterface.html#a7dea07c539e0f0ca765f02d198345d2d">fCurl</a> = nullptr</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pointer used to interact with libcurl. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Singleton used to interact with the Intensity Frontier beam database at Fermilab. </p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="add525c53cbf0b85c3cd0d39a5b9b0fdd"></a><!-- doxytag: member="IFBeamDBInterface::GetBeamStatus" ref="add525c53cbf0b85c3cd0d39a5b9b0fdd" args="(uint64_t time) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classBeamStatus.html">BeamStatus</a> IFBeamDBInterface::GetBeamStatus </td>
          <td>(</td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>time</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get information about the BNB state from the database as close as possible to a given time. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>time</em>&nbsp;</td><td>Timestamp (milliseconds since the Unix epoch) to use when searching the database </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a034ef023cb78989270a4ec2d54a5aa4f"></a><!-- doxytag: member="IFBeamDBInterface::QueryBeamDB" ref="a034ef023cb78989270a4ec2d54a5aa4f" args="(uint64_t t0, uint64_t t1, std::string &amp;response_string) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int IFBeamDBInterface::QueryBeamDB </td>
          <td>(</td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>response_string</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get information about the BNB state from the database for the time interval [t0, t1]. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>t0</em>&nbsp;</td><td>Starting timestamp (milliseconds since the Unix epoch) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>t1</em>&nbsp;</td><td>Starting timestamp (milliseconds since the Unix epoch) </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>response_string</em>&nbsp;</td><td>A string that will be loaded with the csv-format data from the database </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The libcurl integer return code for the query (zero if everything worked ok, or nonzero if an error occurred) </dd></dl>

</div>
</div>
<a class="anchor" id="a7b0e4c42767791f1904540b63772a74d"></a><!-- doxytag: member="IFBeamDBInterface::QueryBeamDB" ref="a7b0e4c42767791f1904540b63772a74d" args="(uint64_t t0, uint64_t t1) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; std::string, std::map&lt; uint64_t, <a class="el" href="structBeamDataPoint.html">BeamDataPoint</a> &gt; &gt; IFBeamDBInterface::QueryBeamDB </td>
          <td>(</td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>t1</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get information about the Booster Neutrino Beam (BNB) state from the database for the time interval [t0, t1]. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>t0</em>&nbsp;</td><td>Starting timestamp (milliseconds since the Unix epoch) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>t1</em>&nbsp;</td><td>Starting timestamp (milliseconds since the Unix epoch) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A nested map containing the parsed data. Keys of the outer map are device names, values are inner maps. Keys of the inner map are timestamps (milliseconds since the Unix epoch), values are <a class="el" href="structBeamDataPoint.html" title="Container to hold values from Intensity Frontier beam database queries, together...">BeamDataPoint</a> structs that hold a numerical value and a unit string. </dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>An easy way to get the current milliseconds since the Unix epoch is to use the terminal utility date like this: <div class="fragment"><pre class="fragment">date +%s%3N
    /// </pre></div> I found this handy trick here: <a href="http://unix.stackexchange.com/a/123764">http://unix.stackexchange.com/a/123764</a> </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>UserTools/BeamFetcher/<a class="el" href="IFBeamDBInterface_8h_source.html">IFBeamDBInterface.h</a></li>
<li>UserTools/BeamFetcher/IFBeamDBInterface.cpp</li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 28 Aug 2019 for ToolDAQFramework by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
